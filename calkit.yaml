owner: calkit
name: example-r
title: R example
description: An example Calkit project that uses R.
git_repo_url: https://github.com/calkit/example-r

environments:
  main:
    kind: renv
    path: DESCRIPTION
  quarto:
    kind: uv
    path: .calkit/envs/quarto/pyproject.toml
    # TODO: tinytex was installed with quarto install

pipeline:
  stages:
    analyze:
      kind: r-script
      script_path: R/analyze.R
      environment: main
      inputs:
        - data/raw/data.csv
      outputs:
        - path: output/analysis_results.rds
          storage: git
        - path: data/processed/data.csv
          storage: git
    plot:
      kind: r-script
      script_path: R/plot.R
      environment: main
      inputs:
        - data/processed/data.csv
      outputs:
        - path: figures/boxplot.pdf
          storage: git
        - path: figures/timeseries.pdf
          storage: git
    render-paper:
      kind: shell-command
      command: quarto render paper.qmd
      environment: quarto
      inputs:
        - paper.qmd
        - references.bib
        - figures/boxplot.pdf
        - figures/timeseries.pdf
        - output/analysis_results.rds
      outputs:
        - paper.pdf

figures:
  - path: figures/boxplot.pdf
    title: Boxplot
    stage: plot
  - path: figures/timeseries.pdf
    title: Time series
    stage: plot

publications:
  - path: paper.pdf
    title: Example Paper
    stage: render-paper

showcase:
  - publication: paper.pdf
